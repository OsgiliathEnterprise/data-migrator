<project name="EntityPostProcessor" default="dist" basedir=".">
    <description>Post process the entities</description>
    <target name="removeEntitiesFKs">
        <replaceregexp byline="true">
            <regexp pattern=",\sprecision=\d(\d+)"/>
            <substitution expression=", precision=9"/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replace token=', nullable=false' value='' dir="${maven.project.build.directory}">
            <include name="**/*.java"/>
        </replace>
        <replace token=', updatable=false' value='' dir="${maven.project.build.directory}">
            <include name="**/*.java"/>
        </replace>
        <replace token=', insertable=false' value='' dir="${maven.project.build.directory}">
            <include name="**/*.java"/>
        </replace>
        <replace token='@Version' value='// @Version' dir="${maven.project.build.directory}">
            <include name="**/*.java"/>
        </replace>
        <replace token='@Table(name="request"' value='@Table(name="\"request\""'
                 dir="${maven.project.build.directory}">
            <include name="**/*.java"/>
        </replace>

        <replace token='@Column(name="TO"' value='@Column(name="\"TO\""'
                 dir="${maven.project.build.directory}">
            <include name="**/*.java"/>
        </replace>
        <replace token='@Column(name="LEFT"' value='@Column(name="\"LEFT\""'
                 dir="${maven.project.build.directory}">
            <include name="**/*.java"/>
        </replace>
        <replace token='@Column(name="FROM"' value='@Column(name="\"FROM\""'
                 dir="${maven.project.build.directory}">
            <include name="**/*.java"/>
        </replace>
        <replace token='@Column(name="USER"' value='@Column(name="\"USER\""'
                 dir="${maven.project.build.directory}">
            <include name="**/*.java"/>
        </replace>
        <replace token='@Column(name="GROUP"' value='@Column(name="\"GROUP\""'
                 dir="${maven.project.build.directory}">
            <include name="**/*.java"/>
        </replace>
        <replaceregexp byline="true">
            <regexp pattern="@GenericGenerator\([^)]*\)"/>
            <substitution expression=""/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp byline="true">
            <regexp pattern="@GeneratedValue\(.*\)"/>
            <substitution expression="@GeneratedValue"/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>

        <replaceregexp byline="true">
            <regexp pattern="@JoinColumn\(\n*\s*((?:(?!forei).)+)"/>
            <substitution
                    expression="@JoinColumn(foreignKey = @jakarta.persistence.ForeignKey(jakarta.persistence.ConstraintMode.NO_CONSTRAINT), \1"/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp byline="true">
            <regexp pattern="@PrimaryKeyJoinColumn$"/>
            <substitution
                    expression="@PrimaryKeyJoinColumn(foreignKey = @jakarta.persistence.ForeignKey(jakarta.persistence.ConstraintMode.NO_CONSTRAINT))"/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp byline="true">
            <regexp pattern="@JoinColumns\(\n*\s*((?:(?!forei).)+)"/>
            <substitution
                    expression="@JoinColumns(foreignKey = @jakarta.persistence.ForeignKey(jakarta.persistence.ConstraintMode.NO_CONSTRAINT), value = \1"/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp byline="true">
            <regexp pattern="@JoinTable\(\n*\s*((?:(?!forei).)+)"/>
            <substitution
                    expression="@JoinTable(foreignKey = @jakarta.persistence.ForeignKey(jakarta.persistence.ConstraintMode.NO_CONSTRAINT), inverseForeignKey = @jakarta.persistence.ForeignKey(jakarta.persistence.ConstraintMode.NO_CONSTRAINT), \1"/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp byline="true">
            <regexp pattern="@OneToMany\(\n*\s*((?:(?!cascade).)+)"/>
            <substitution
                    expression="@OneToMany(cascade = jakarta.persistence.CascadeType.PERSIST, \1"/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp byline="true">
            <regexp pattern="@ManyToOne\(\n*\s*((?:(?!cascade).)+)"/>
            <substitution
                    expression="@ManyToOne(cascade = jakarta.persistence.CascadeType.PERSIST, \1"/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>

        <replaceregexp byline="true">
            <regexp pattern="@ManyToMany\(\n*\s*((?:(?!cascade).)+)"/>
            <substitution
                    expression="@ManyToMany(cascade = jakarta.persistence.CascadeType.PERSIST, \1"/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp byline="true">
            <regexp pattern="@OneToOne\(\n*\s*((?:(?!cascade).)+)"/>
            <substitution
                    expression="@OneToOne(cascade = jakarta.persistence.CascadeType.PERSIST, \1"/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp byline="true">
            <regexp pattern="cascade.+,"/>
            <substitution
                    expression=""/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <!--<replaceregexp flags="gm">
            <regexp pattern="^.*@OneToOne[^;]*;[^\}]*}[^;]*;[^\}]*}$"/>
            <substitution expression=""/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp flags="gm">
            <regexp pattern="^.*@OneToMany[^;]*;[^\}]*}[^;]*;[^\}]*}$"/>
            <substitution expression=""/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp flags="gm">
            <regexp pattern="^.*@ManyToOne[^;]*;[^\}]*}[^;]*;[^\}]*}$"/>
            <substitution expression=""/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>
        <replaceregexp flags="gm">
            <regexp pattern="^.*@ManyToMany[^;]*;[^\}]*}[^;]*;[^\}]*}$"/>
            <substitution expression=""/>
            <fileset dir="${maven.project.build.directory}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>-->
    </target>
</project>
